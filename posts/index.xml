<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on &amp;#xF8FF;页面仔的笔记</title><link>/posts/</link><description>Recent content in Posts on &amp;#xF8FF;页面仔的笔记</description><generator>Hugo -- gohugo.io</generator><language>zh</language><copyright>&amp;copy;2019 LayoutBoy.</copyright><lastBuildDate>Sat, 11 Jan 2020 14:34:44 +0800</lastBuildDate><atom:link href="/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>macOS 上开启内置的 HTTP Server</title><link>/posts/2020/01/11_macos_httpserver/</link><pubDate>Sat, 11 Jan 2020 14:34:44 +0800</pubDate><guid>/posts/2020/01/11_macos_httpserver/</guid><description>macOS 内置有 Apache 服务，只是默认是关闭的。 启动 Apache 服务： sudo apachectl start 切换到要启动 Web 服务的目录： cd ./webroot/ python -m SimpleHTTPServer 8080 可以看到启动日志： Serving HTTP on 0.0.0.0 port 8080 ... 就可以用浏览器访问</description></item><item><title>解决 space-between 最后一行的对齐问题</title><link>/posts/2020/01/02_flex_after/</link><pubDate>Thu, 02 Jan 2020 20:43:20 +0800</pubDate><guid>/posts/2020/01/02_flex_after/</guid><description>接这篇文章。 如果给 .flex 容器加上 space-between 平均分布对齐的方式： .flex { ... justify-content: space-between; ... } space-between 的效果 因为最后一行的元素数量特别少，平均到的间距就很大。 但是这不符合设计预</description></item><item><title>CSS flex wrap 布局中设置元素间距</title><link>/posts/2020/01/02_css_flex_wrap_margin/</link><pubDate>Thu, 02 Jan 2020 00:00:00 +0800</pubDate><guid>/posts/2020/01/02_css_flex_wrap_margin/</guid><description>CSS flex wrap 布局里，没有直接设置间距的参数，默认情况下各元素会紧贴着排列在一起。 一个普通的 flex wrap 布局代码： .box { width: 414px; height: 736px; margin: 0 auto; border: 1px solid blue; } .flex { display: flex; flex-wrap: wrap; border:</description></item><item><title>Swift 使用字面量协议扩展 DispatchTime</title><link>/posts/2019/12/30_dispatch_time_extension/</link><pubDate>Mon, 30 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/30_dispatch_time_extension/</guid><description>DispatchTime 的参数是时间，单位既不是秒也不是毫秒，而是纳秒。 使用的方法如下： DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + .seconds(5)) { //Doyourworkhere } 延迟 5 秒执行，就要写为：DispatchTime.now()</description></item><item><title>checkra1n 越狱后连接 SSH</title><link>/posts/2019/12/28_ssh_checkra1n/</link><pubDate>Sat, 28 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/28_ssh_checkra1n/</guid><description>checkra1n是利用硬件漏洞越狱的工具，与操作系统版本无关。 支持的设备是 iPhone 5s – iPhone X，iOS 12.3+ 越狱成功后默认已经运行了 SSH 服务，端口号是 44</description></item><item><title>使用 Github Pages 发布博客</title><link>/posts/2019/12/28_github_pages/</link><pubDate>Sat, 28 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/28_github_pages/</guid><description>不同于网上的教程，我不依赖 Web Hooks。 在 Github 上创建一个公开仓库，并且开通 Pages 服务（通过创建 用户名.github.io 仓库或者给现有仓库创建 gh-pages 分</description></item><item><title>本博客启用 LayoutBoy.com 域名</title><link>/posts/2019/12/28_layoutboy/</link><pubDate>Sat, 28 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/28_layoutboy/</guid><description>本博客正式使用永久域名： LayoutBoy.com Layout Boy：页面仔</description></item><item><title>在越狱后的 iOS 上更新 Lookin 链接库</title><link>/posts/2019/12/27_update_lookin_on_jb_ios/</link><pubDate>Fri, 27 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/27_update_lookin_on_jb_ios/</guid><description>Lookin 是免费的 iOS App UI 分析工具，还具有简单的动态调试功能。 越狱后如果要对第三方 App 进行界面分析，需要安装 LookinLoader 插件。 这个插件加载 LookinServer.framework 的路径是 /usr/li</description></item><item><title>Hugo 主题开发笔记</title><link>/posts/2019/12/26_hugo_theme_dev_tips/</link><pubDate>Thu, 26 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/26_hugo_theme_dev_tips/</guid><description>我的极简 Hugo 主题 Notepadium 已被收录到官方主题推荐列表。 记录一下开发过程中的一些心得。 开发过程中 避免生成多余空行 Hugo 处理源文件时，会把 go 标记 {{ }} 所在行替换</description></item><item><title>使用 OpenSSL 计算脚本文件的 SHA384</title><link>/posts/2019/12/25_h5_hash/</link><pubDate>Wed, 25 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/25_h5_hash/</guid><description>比如要计算 CDN 中 MathJax 的 sha384，先把脚本下载回来： curl -O https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js openssl dgst -sha384 -binary MathJax.js | openssl base64 -A 输出结果： e/4/LvThKH1gwzXhdbY2AsjR3rm7LHWyhIG5C0jiRfn8AN2eTN5ILeztWw0H9jmN% 最后的 % 表示结束，不是 Hash 的一部分。 使用如下： &amp;lt;script defer type=&amp;#34;text/javascript&amp;#34; src=&amp;#34;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML&amp;#34; integrity=&amp;#34;sha384-e/4/LvThKH1gwzXhdbY2AsjR3rm7LHWyhIG5C0jiRfn8AN2eTN5ILeztWw0H9jmN&amp;#34;</description></item><item><title>给 MathJax 加上 Github 风格语法高亮</title><link>/posts/2019/12/25_highlight_math/</link><pubDate>Wed, 25 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/25_highlight_math/</guid><description>先看效果图： 添加以下 CSS 代码即可： .markdown-body p &amp;gt; span.math { display: inline-block; font-size: 85%; padding: 2px 4px; border-radius: 3px; color: #24292e; background-color: #f6f8fa; } .markdown-body .math .mo { color: #d73a49; } .markdown-body .math .mn { color: #005cc5; }</description></item><item><title>使用 Hugo v0.62 的渲染钩子（Render hooks）</title><link>/posts/2019/12/24_hugo_render_hooks/</link><pubDate>Tue, 24 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/24_hugo_render_hooks/</guid><description>Hugo 发布了新版本 0.62.0，新增加了 Markdown 渲染钩子（Render Hooks）的功能。 渲染钩子是 Goldmark 引擎的新特性，利用渲染钩子可以替代 shortcode 来实现自定义</description></item><item><title>iOS 格式化浮点数时去掉末尾的 0</title><link>/posts/2019/12/16_float_short/</link><pubDate>Mon, 16 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/16_float_short/</guid><description>有时候需要把浮点数格式化为字符串显示到界面上，需要去掉末尾多余的 0。 例如 108 * 0.95 希望界面上显示的结果为 102.6 而不是 102.600000 很简单，使用下面的方式进行格式</description></item><item><title>运用 AutoLayout 的优先级例子</title><link>/posts/2019/12/14_ios_autolayout_priority/</link><pubDate>Sat, 14 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/14_ios_autolayout_priority/</guid><description>当约束条件发生冲突时，系统会使用用优先级高的约束。 还可以通过设置约束为 deactive 状态来使约束不生效。 利用好约束的优先级，可以使布局代码简洁、逻辑清晰</description></item><item><title>导出全部 Chroma 主题 CSS 文件</title><link>/posts/2019/12/11_export_all_chroma_themes/</link><pubDate>Wed, 11 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/11_export_all_chroma_themes/</guid><description>Chroma 是 hugo 默认使用的开源语法高亮引擎，使用 Go 语言编写，渲染速度很快。 使用以下 shell 脚本可以把内置的主题都导出为 CSS 文件： #!/bin/zsh styles=( \ abap \ algol \ algol_nu \ api \ arduino \ autumn \</description></item><item><title>给 Hugo 开启 Disqus 评论系统</title><link>/posts/2019/12/10_hugo_disqus/</link><pubDate>Tue, 10 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/10_hugo_disqus/</guid><description>Hugo 已经内置了 Disqus 的模版，开启 Disqus 相当简单。 参考官方文档： https://gohugo.io/content-management/comments/ 首先需要注册一个 Disqus 帐号，官网是 https://disqus.com/ 然后创建一个站点，站点名称可以随意，这个名字稍后要用到</description></item><item><title>在 iOS 里使用 Flexbox 布局</title><link>/posts/2019/12/08_ios_flexlayout/</link><pubDate>Sun, 08 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/08_ios_flexlayout/</guid><description>iOS 目前只有手动布局和自动布局两种方式，flexbox 布局只能引入第三方库进行支持 这个布局的思想是来自 CSS 里的 flexbox，关于 CSS Flexbox 可以参考这</description></item><item><title>在 Hugo 的 Markdown 里直接使用 HTML</title><link>/posts/2019/12/06_raw_html_with_hugo/</link><pubDate>Thu, 05 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/06_raw_html_with_hugo/</guid><description>hugo 在处理 Markdown 文档的时候会忽略里面的 HTML 代码，如果想在 Markdown 里嵌入 HTML 代码，可以使用 hugo 的 shortcode 来实现。 在 layouts/shortcodes 里新建一个 raw.html 文件，如果路径不存在可以用命令 mkdir -p layouts/shortcodes 创</description></item><item><title>在 swift 里扩展 UIColor 使用十六进制颜色值</title><link>/posts/2019/12/05_hexcolor_alpha/</link><pubDate>Thu, 05 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/05_hexcolor_alpha/</guid><description>4.2. The RGB hexadecimal notations: #RRGGBB 十六进制颜色表示方式是 #RRGGBB（6位），带 alpha 的表示方式是 #RRGGBBAA（8位） 取值范围是 00 - FF。 十六进制颜色缩写的表</description></item><item><title>了解 Image 的 capInsets 和 resizingMode</title><link>/posts/2019/12/04_image_resizingmode/</link><pubDate>Wed, 04 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/04_image_resizingmode/</guid><description>拉伸 UIImage 的时候使用的方法是 resizableImage，它的声明如下： func resizableImage( withCapInsets capInsets: UIEdgeInsets, resizingMode: UIImage.ResizingMode ) -&amp;gt; UIImage capInsets 指定要保护的区域，就是图像的四个角落，如果大小是 0</description></item><item><title>视网膜屏幕下像素对齐计算方法</title><link>/posts/2019/12/03_pix_aligned/</link><pubDate>Tue, 03 Dec 2019 00:00:00 +0800</pubDate><guid>/posts/2019/12/03_pix_aligned/</guid><description>使用 CoreGraphics 裁剪图片的时候如果计算后的尺寸没有像素对齐，得出的图像就会有 1px 的黑边。 例如需要计算出 0.5 的高度在当前屏幕下需要多少像素进行显示，像素对齐</description></item><item><title>在 netlify 使用最新版本的 hugo 和 go 构建网站</title><link>/posts/2019/11/29_newest_hugo_and_go_version_on_netlify/</link><pubDate>Fri, 29 Nov 2019 00:00:00 +0800</pubDate><guid>/posts/2019/11/29_newest_hugo_and_go_version_on_netlify/</guid><description>如果你使用 hugo 构建网站，那么一定知道 hugo 最近新发布了 v0.60 版本 hugo v0.60 开始，更换了默认的 markdown 渲染内核，使用更快的 goldmark。 默认设置下 netlify 使用的是保守</description></item><item><title>制作一个极速 Hugo 主题</title><link>/posts/2019/11/24_a_simple_hugo_theme/</link><pubDate>Sun, 24 Nov 2019 00:00:00 +0800</pubDate><guid>/posts/2019/11/24_a_simple_hugo_theme/</guid><description>Hugo 是一个静态网站生成工具，具有生成速度很快、简单易学的特点。 官网是 https://gohugo.io 官网已经提供了丰富的主题，但我依然选择自己制作一款主题自己使用。 主要是自</description></item><item><title>Git 操作技巧</title><link>/posts/2019/11/20_git_tricks/</link><pubDate>Wed, 20 Nov 2019 00:00:00 +0800</pubDate><guid>/posts/2019/11/20_git_tricks/</guid><description>删除远程仓库所有 tag git push origin --delete $(git tag -l) 执行后将删除远程仓库的所有 tag。 不过，本地已经拉取回来的 tag 还在。 创建一个没有任何提交记录的分支 git checkout --orphan branche-name</description></item><item><title>在 iOS 里 100% 还原 Sketch 实现的阴影效果</title><link>/posts/2019/11/19_ios_sketch_shadow/</link><pubDate>Tue, 19 Nov 2019 00:00:00 +0800</pubDate><guid>/posts/2019/11/19_ios_sketch_shadow/</guid><description>还原不了设计师视觉稿的开发者不是一个合格的页面仔。 Sketch 是 APP 设计的神器，大部分设计师都选择它作为 APP 界面的设计工具。 在 Sketch 里设置一个阴影，效果图和参</description></item><item><title>给 Xcode 添加最新的 iOS DeviceSupport</title><link>/posts/2019/11/18_iosdevicesupport/</link><pubDate>Mon, 18 Nov 2019 00:00:00 +0800</pubDate><guid>/posts/2019/11/18_iosdevicesupport/</guid><description>默认情况下 Xcode 只能调试其内置对应的 iOS 版本，如果发布了新的 iOS 版本而没有更新到与之对应的新版本 Xcode，就不能进行调试了。 要解决这个问题， 需要在</description></item><item><title>swift 里正确的实现一个 NSTextStorage 子类</title><link>/posts/2019/11/11_swift_subclass_nstextstorage/</link><pubDate>Mon, 11 Nov 2019 00:00:00 +0800</pubDate><guid>/posts/2019/11/11_swift_subclass_nstextstorage/</guid><description>即使你按照官方的文档来操作依然有可能会掉进坑里，因为 swift 的实现和 objc 稍有不同。 NSTextStorage 是基于 NSMutableAttributedString 的一个虚基类。 这意味着当你写一个 NSTextStorage 的子类时，必须正确实现</description></item><item><title>免费的国内 git 代码托管服务</title><link>/posts/2019/11/07_git_server_in_china/</link><pubDate>Thu, 07 Nov 2019 00:00:00 +0800</pubDate><guid>/posts/2019/11/07_git_server_in_china/</guid><description>码云 官网： https://gitee.com 功能最为丰富，Pages 需要付费才能使用自定义域名和 https Coding 官网： https://coding.net 已被腾讯收购，Pages 功能免费提供自定义域名和 https 阿里云 官网： https://code.aliyun.com</description></item><item><title>iOS 13 下访问受限制的 _ivar</title><link>/posts/2019/06/09-ios13-ivar-kvc-appbug/</link><pubDate>Sun, 09 Jun 2019 00:00:00 +0800</pubDate><guid>/posts/2019/06/09-ios13-ivar-kvc-appbug/</guid><description>在 iOS 13 之前，一般是使用 KVC 来实现访问私有的实例变量，比如要访问 UITextField 的 _placeholderLabel 一般会这么做： extension UITextField { var placeholderLabel: UILabel? { get { return value(forKey: &amp;#34;_placeholderLabel&amp;#34;) as? UILabel } } } 一直到 iOS 12，这个方法运行</description></item><item><title>模仿微信适配 iPad 的布局方式</title><link>/posts/2019/05/08_wechat_style_splitviewcontroller/</link><pubDate>Wed, 08 May 2019 00:00:00 +0800</pubDate><guid>/posts/2019/05/08_wechat_style_splitviewcontroller/</guid><description>微信在 iPad 上竖屏时显示的样式和手机版一样，横屏的显示为分隔视图。 UIKit 里可以实现这样的效果的组件是UISplitViewController。 接下</description></item><item><title>Fix Reveal load error in iOS 12 (jailbreaked)</title><link>/posts/2019/05/02_fix_reveal_for_ios12jb/</link><pubDate>Thu, 02 May 2019 00:00:00 +0800</pubDate><guid>/posts/2019/05/02_fix_reveal_for_ios12jb/</guid><description>After install CCRevealLoader, RevealServer.framework installed at /Library/Application Support/CCRevealLoader/RevealServer.framework
file system sandbox blocked mmap When loading Reveal server
a solution: move RevealServer.framework to /Library/TweakInject/
mv &amp;#34;/Library/Application Support/CCRevealLoader/RevealServer.framework&amp;#34; /Library/TweakInject/ ln -s /Library/TweakInject/RevealServer.framework /Library/Application\ Support/CCRevealLoader/ That`s OK now.</description></item><item><title>rsshub with TLS</title><link>/posts/2019/05/01_rsshub_with_tls/</link><pubDate>Wed, 01 May 2019 00:00:00 +0800</pubDate><guid>/posts/2019/05/01_rsshub_with_tls/</guid><description>Deploy rsshub rsshub server listen 127.0.0.1:1200
docker-compose.yml
version:&amp;#39;3&amp;#39;services:rsshub:image:&amp;#39;diygod/rsshub&amp;#39;Deploy nginx docker-compose.yml
version:&amp;#39;3&amp;#39;services:nginx:image:&amp;#39;cntrump/ubuntu_nginx_boringssl&amp;#39;volumes:-/opt/nginx/etc:/etc/nginx-/opt/nginx/log:/var/log/nginx-/opt/nginx/cache:/var/cache/nginx-/opt/www:/var/wwwports:-&amp;#39;80:80&amp;#39;-&amp;#39;443:443&amp;#39;command:/usr/sbin/nginx-g&amp;#34;daemon off;&amp;#34;Reverse proxy, using http 1.1 with tls 1.2/1.3
nginx.conf
{ ... # HTTPS server server { listen 443 ssl; server_name localhost; ssl_protocols TLSv1.2 TLSv1.3; ssl_certificate /etc/nginx/certs/fullchain.pem; ssl_certificate_key /etc/nginx/certs/privkey.pem; location / { proxy_redirect off; proxy_pass http://rsshub:1200; # rsshub is service name which defined in docker-compose.yml proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection &amp;#34;upgrade&amp;#34;; proxy_set_header Host $http_host; # Show realip in v2ray access.</description></item><item><title>在 iOS 中使用 icofont 字体</title><link>/posts/2019/04/30_using_icofont/</link><pubDate>Tue, 30 Apr 2019 00:00:00 +0800</pubDate><guid>/posts/2019/04/30_using_icofont/</guid><description>获取 icofont 可以在 icofont.com 下载到 icofont.ttf，里面包含了很多图标。 把下载回来的 icofont.ttf 拖到项目里，或者新建一个 fonts.bundle 用来放字体资源。 在 APP 启动的时候注册字</description></item><item><title>在 ObjC 项目里使用 Swift 静态库</title><link>/posts/2019/03/29_using_static_swift_in_objc/</link><pubDate>Fri, 29 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/29_using_static_swift_in_objc/</guid><description>Xcode 9 开始 Swift 支持编译生成静态类型的 framework 如果给之前的 ObjC 项目直接添加 Swift 写的 framework，在编译的时候会报错，错误信息是无法找到 Swift 的方法。 解决方</description></item><item><title>git with GPG sign</title><link>/posts/2019/03/25_git_with_gpg/</link><pubDate>Mon, 25 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/25_git_with_gpg/</guid><description>Setup GPG pub key for git server Install GPG Suite or gpgosx on macOS Create a GPG key Setup GPG pub key for github or gitlab etc. Setup GPG key for git client List all GPG key gpg -K Setup signingkey for git git config user.signingkey your-key Enable gpgsign for git commit git config commit.gpgsign true using gpg2
git config --global gpg.program $(which gpg2)</description></item><item><title>GNU auto tools</title><link>/posts/2019/03/25_gnu_auto_tools/</link><pubDate>Mon, 25 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/25_gnu_auto_tools/</guid><description>The GNU Autotools:
Autoconf Automake Libtool (Xcode built-in) Gettext</description></item><item><title>Make carthage portable</title><link>/posts/2019/03/23_make_carthage_portable/</link><pubDate>Sat, 23 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/23_make_carthage_portable/</guid><description>I wanna run carthage without install CarthageKit.framework to system library.
Download latest release get latest carthage pkg form https://github.com/Carthage/Carthage/releases
Extract pkg file pkgutil --expand-full Carthage.pkg Carthage Copy to system path cp Carthage/CarthageApp.pkg/Payload/usr/local/bin/carthage /usr/local/bin mkdir -p /usr/local/Library/Frameworks cp -r Carthage/CarthageApp.pkg/Payload/Library/Frameworks/CarthageKit.framework /usr/local/Library/Frameworks Add rpath for carthage install_name_tool -add_rpath @executable_path/../Library/Frameworks /usr/local/bin/carthage install_name_tool -add_rpath @executable_path/../Library/Frameworks/CarthageKit.framework/Versions/Current/Frameworks /usr/local/bin/carthage All done.
I using a shell script make it easy
#!/bin/bash set -e if [ ! -f Carthage.</description></item><item><title>fatal: cannot run gpg: No such file or directory</title><link>/posts/2019/03/22_fix_cannot_run_gpg/</link><pubDate>Fri, 22 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/22_fix_cannot_run_gpg/</guid><description>After installed GPG Site: https://gpgtools.org/
Git commit with error:
fatal: cannot run gpg: No such file or directory error: gpg failed to sign the data fatal: failed to write commit object Solution:
git config --global gpg.program $(which gpg) About Signing commits</description></item><item><title>Using xcrun</title><link>/posts/2019/03/22_using_xcrun/</link><pubDate>Fri, 22 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/22_using_xcrun/</guid><description>Run a command with special toolchain # using clang of toolchain org.llvm.8.0.0 xcrun --toolchain org.llvm.8.0.0 clang -v output
clang version 8.0.0 Target: x86_64-apple-darwin18.2.0 Thread model: posix InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/LLVM8.0.0.xctoolchain/usr/bin Show SDK path xcrun --show-sdk-path --sdk iphoneos /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS12.1.sdk xcrun --show-sdk-path --sdk iphonesimulator /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator12.1.sdk xcrun --show-sdk-path --sdk macosx /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk</description></item><item><title>build LLVM 8 on macOS</title><link>/posts/2019/03/21_build_llvm8/</link><pubDate>Thu, 21 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/21_build_llvm8/</guid><description>TL;DR
download my pre-built:
LLVM8.0.1.xctoolchain.7z
MD5: 32241cb3e093b15c58bd40200dc2fd76
LLVM8.0.0.xctoolchain.7z
MD5: 169fd4d3fdffa5a136cbe77aac759cdc
prepare building lldb Install editline Install pcre &amp;amp;&amp;amp; swig Read code-signing.txt building clone llvm-project checkout 8.0 branch cd llvm run build-llvm.sh build-llvm.sh
#!/bin/bash set -e mkdir build &amp;amp;&amp;amp; cd build output=/tmp/llvm-build cmake -DCMAKE_INSTALL_PREFIX=${output} \ -DCMAKE_BUILD_TYPE=Release \ -DLLVM_INCLUDE_TESTS=OFF \ -DLLVM_INCLUDE_EXAMPLES=OFF \ -DLLDB_CODESIGN_IDENTITY=&amp;#39;&amp;#39; \ -DLLDB_BUILD_FRAMEWORK=ON \ -DLLVM_ENABLE_PROJECTS=&amp;#34;all&amp;#34; \ -DLLVM_CREATE_XCODE_TOOLCHAIN=ON \ -DCMAKE_OSX_DEPLOYMENT_TARGET=10.</description></item><item><title>A simple Dispatch Queue Pool</title><link>/posts/2019/03/18_a_simple_dispatch_pool/</link><pubDate>Mon, 18 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/18_a_simple_dispatch_pool/</guid><description>I named it MDispatchQueuePool.
Really easy to use:
[MDispatchQueuePool.sharedPool asyncExecute:^{ // put your code here ... }]; Here is MDispatchQueuePool.m
@interface MDispatchQueuePool () { dispatch_queue_t _executionQueue; dispatch_queue_t _waitingQueue; dispatch_semaphore_t _maximumQueueSemaphore; } @end @implementation MDispatchQueuePool + (instancetype)sharedPool { static MDispatchQueuePool *pool = nil; static dispatch_once_t onceToken = 0; dispatch_once(&amp;amp;onceToken, ^{ pool = [[self alloc] init]; }); return pool; } - (instancetype)init { if (self = [super init]) { _executionQueue = dispatch_queue_create(&amp;#34;queue.exec.MDispatchQueuePool&amp;#34;, DISPATCH_QUEUE_CONCURRENT); _waitingQueue = dispatch_queue_create(&amp;#34;queue.</description></item><item><title>Build LLVM for macOS</title><link>/posts/2019/03/13_build_llvm/</link><pubDate>Wed, 13 Mar 2019 00:00:00 +0800</pubDate><guid>/posts/2019/03/13_build_llvm/</guid><description>Build LLVM We build a toolchain for Xcode, and include these projects: clang clang-tools-extra libcxx libcxxabi compiler-rt libunwind polly lld clone llvm project, and build the 7.0.1 version git clone https://github.com/llvm/llvm-project.git llvm-project cd llvm-project/llvm git checkout llvmorg-7.0.1 mkdir build &amp;amp;&amp;amp; cd build &amp;amp;&amp;amp; build_llvm.sh Build obfuscator-LLVM obfuscator-LLVM upon LLVM, so We must clone LLVM project first. We build heroims&amp;rsquo; fork, because his fork is newer. cd llvm-project git clone https://github.com/heroims/obfuscator.git</description></item><item><title>Build boringssl for iOS</title><link>/posts/2019/02/16-build_boringssl_for_ios/</link><pubDate>Sat, 16 Feb 2019 00:00:00 +0800</pubDate><guid>/posts/2019/02/16-build_boringssl_for_ios/</guid><description>Clone boringssl git clone https://github.com/google/boringssl.git boringssl Build boringssl cd boringssl mkdir build &amp;amp;&amp;amp; cd build ./build.ios build.ios is my build script
#!/bin/bash set -e export IPHONEOS_DEPLOYMENT_TARGET=&amp;#34;9.0&amp;#34; # for -miphoneos-version-min arch=arm64 mkdir ${arch} &amp;amp;&amp;amp; cd ${arch} cmake -DCMAKE_OSX_SYSROOT=iphoneos -DCMAKE_OSX_ARCHITECTURES=${arch} -GNinja ../.. ninja cd .. arch=armv7 mkdir ${arch} &amp;amp;&amp;amp; cd ${arch} cmake -DCMAKE_OSX_SYSROOT=iphoneos -DCMAKE_OSX_ARCHITECTURES=${arch} -GNinja ../.. ninja cd .. arch=x86_64 mkdir ${arch} &amp;amp;&amp;amp; cd ${arch} cmake -DCMAKE_OSX_SYSROOT=iphonesimulator -DCMAKE_OSX_ARCHITECTURES=${arch} -GNinja ../.. ninja cd .</description></item><item><title>Build extern version of hugo</title><link>/posts/2019/02/15-build_extern_version_of_hugo/</link><pubDate>Fri, 15 Feb 2019 00:00:00 +0800</pubDate><guid>/posts/2019/02/15-build_extern_version_of_hugo/</guid><description>Official hugo do'nt support scss
Build extern version of hugo from source git clone https://github.com/gohugoio/hugo.git hugo cd hugo go install --tags extended Copy hugo to system path sudo cp ~/go/bin/hugo /usr/bin Check hugo version infomation hugo version Hugo Static Site Generator v0.55.0-DEV/extended darwin/amd64 BuildDate: unknown</description></item><item><title>nginx with boringssl</title><link>/posts/2019/01/27_docker-nginx/</link><pubDate>Sun, 27 Jan 2019 00:00:00 +0800</pubDate><guid>/posts/2019/01/27_docker-nginx/</guid><description>build with boringssl enable TLS 1.3 enable 0-RTT Install &amp;amp; Run mount log dir to /opt/nginx/log config dir to /opt/nginx/etc web root to /opt/www docker pull cntrump/ubuntu_nginx_boringssl docker run -v /opt/nginx/etc:/etc/nginx -v /opt/nginx/log:/var/log/nginx -v /opt/www:/var/www -v /opt/nginx/cache:/var/cache/nginx -p 80:80 -p 443:443 -d cntrump/ubuntu_nginx_boringssl /usr/sbin/nginx -g &amp;#34;daemon off;&amp;#34; Using docker-compose docker-compose.yml
version:&amp;#39;3&amp;#39;services:nginx:image:&amp;#39;cntrump/ubuntu_nginx_boringssl&amp;#39;volumes:-/opt/nginx/etc:/etc/nginx-/opt/nginx/log:/var/log/nginx-/opt/nginx/cache:/var/cache/nginx-/opt/www:/var/wwwports:-&amp;#39;80:80&amp;#39;-&amp;#39;443:443&amp;#39;command:/usr/sbin/nginx-g&amp;#34;daemon off;&amp;#34;deploy:restart_policy:condition:on-failuredelay:5smax_attempts:3window:120sdocker-compose start/stop/restart nginx Example nginx.conf A+ configuration for https://myssl.com
user nginx; worker_processes 1; #error_log logs/error.log; #error_log logs/error.</description></item><item><title>Build nginx with boringssl on Ubuntu 18.04</title><link>/posts/2019/01/24-build_nginx_with_boringssl/</link><pubDate>Thu, 24 Jan 2019 00:00:00 +0800</pubDate><guid>/posts/2019/01/24-build_nginx_with_boringssl/</guid><description>Enable TLS 1.3 support Using official confiuration Using shell script #!/bin/sh set -e apt-get install build-essential curl git cmake ninja-build golang libpcre3-dev zlib1g-dev # build boringssl git clone --depth=1 https://github.com/google/boringssl.git cd boringssl mkdir build cd build cmake -GNinja .. ninja cd ../.. mkdir -p boringssl/.openssl/lib cp boringssl/build/crypto/libcrypto.a boringssl/build/ssl/libssl.a boringssl/.openssl/lib cd boringssl/.openssl ln -s ../include . cd ../.. # build nginx nginx_ver=1.15.8 curl -O https://nginx.org/download/nginx-${nginx_ver}.tar.gz tar zxvf nginx-${nginx_ver}.tar.gz cd nginx-${nginx_ver} .</description></item><item><title>Install newest nginx on ubuntu 18.04</title><link>/posts/2019/01/17-install_nginx_on_ubuntu/</link><pubDate>Thu, 17 Jan 2019 00:00:00 +0800</pubDate><guid>/posts/2019/01/17-install_nginx_on_ubuntu/</guid><description>Install nginx_signing.key cd /etc/apt curl -O https://nginx.org/keys/nginx_signing.key apt-key add nginx_signing.key Update apt source vim /etc/apt/sources.list deb http://nginx.org/packages/ubuntu/ bionic nginx deb-src http://nginx.org/packages/ubuntu/ bionic nginx apt-get update apt-get install nginx</description></item><item><title>Setup flutter for iOS without homebrew on macOS</title><link>/posts/2019/01/15-setup_flutter/</link><pubDate>Tue, 15 Jan 2019 00:00:00 +0800</pubDate><guid>/posts/2019/01/15-setup_flutter/</guid><description>requirements: macports
Install cocoapods sudo gem install cocoapods Deploy to iOS devices sudo port install usbmuxd libimobiledevice ideviceinstaller ios-deploy pod setup Get the Flutter SDK current stale version: 1.0.0 flutter_macos_v1.0.0-stable.zip
unzip flutter_macos_v1.0.0-stable.zip Add the flutter tool to your path:
export PATH=$PATH:`pwd`/flutter/bin</description></item><item><title>Install Chisel for Xcode without brew</title><link>/posts/2019/01/14-chisel/</link><pubDate>Mon, 14 Jan 2019 00:00:00 +0800</pubDate><guid>/posts/2019/01/14-chisel/</guid><description>Clone Chisel git clone https://github.com/facebook/chisel.git chisel Build and install chisel.framework cd chisel/Chisel sudo make install Setup chisel commands vim ~/.lldbinit # ~/.lldbinit command script import /your/repo/chisel/fblldb.py script fblldb.loadCommandsInDirectory(&amp;#39;/your/repo/chisel/commands&amp;#39;)</description></item><item><title>Get free SSL/TLS Certificates from Let's Encrypt</title><link>/posts/2019/01/13-ltsssl/</link><pubDate>Sun, 13 Jan 2019 00:00:00 +0800</pubDate><guid>/posts/2019/01/13-ltsssl/</guid><description>My platform: macOS + macports
Install certbot sudo port install certbot Write a shell script make_cert.sh
#!/bin/sh set -e sudo certbot --duplicate certonly -d &amp;#34;*.$1&amp;#34; -d &amp;#34;$1&amp;#34; --manual --preferred-challenges dns-01 --server https://acme-v02.api.letsencrypt.org/directory Usage make_cert.sh domain.com Configure nginx Copy all certs to /etc/nginx/cert
On Ubuntu
vim /etc/nginx/sites-available/default Enable ssl configuration
ssl on; ssl_certificate /etc/nginx/cert/fullchain.pem; ssl_certificate_key /etc/nginx/cert/privkey.pem;</description></item><item><title>Change toolchain for Xcode</title><link>/posts/2018/12/20_xcode_toolchain/</link><pubDate>Thu, 20 Dec 2018 00:00:00 +0800</pubDate><guid>/posts/2018/12/20_xcode_toolchain/</guid><description>Change toolchain for Xcode something about Xcode toolchian:
Default toolchain location is /Applications/Xcode.app/Contents/Developer/Toolchains Extension of xcode toolchain bundle is .xctoolchain Display name and identifier of toolchain is defined in .xctoolchain/ToolchainInfo.plist CFBundleIdentifier : toolchain bundle identifier DisplayName : name displayed in Xcode menu All binaries, headers, libs etc in .xctoolchain/usr From menu Xcode - Toolchains to switch toolchians If you want install toolchain out of Xcode, the location is /Library/Developer/Toolchains If your toolchain is installed in /Library/Developer/Toolchains, must add CompatibilityVersion key to ToolchainInfo.</description></item><item><title>Calc NSAttributedString size correctly with NSLayoutManager</title><link>/posts/2018/12/16_textkit-tips/</link><pubDate>Sun, 16 Dec 2018 00:00:00 +0800</pubDate><guid>/posts/2018/12/16_textkit-tips/</guid><description>Some code like this:
NSAttributedString *attrString = [[NSAttributedString alloc] initWithString:@&amp;#34;lvv&amp;#34; attributes:@{NSFontAttributeName:[UIFont systemFontOfSize:30]}]; NSTextStorage *textStorage = [[NSTextStorage alloc] initWithAttributedString:attrString]; NSLayoutManager *layoutManager = [[NSLayoutManager alloc] init]; [textStorage addLayoutManager:layoutManager]; NSTextContainer *textContainer = [[NSTextContainer alloc] initWithSize:CGSizeMake(INFINITY, INFINITY)]; [layoutManager addTextContainer:textContainer]; CGRect usedRect = [layoutManager usedRectForTextContainer:textContainer]; NSLog(@&amp;#34;usedRect:%@&amp;#34;, NSStringFromCGRect(usedRect)); result is CGRectZero:
usedRect:{{0, 0}, {0, 0}} Why?
Because glyph generation, layout and font fallback not have happened yet.
Just adjust code simply:
NSAttributedString *attrString = [[NSAttributedString alloc] initWithString:@&amp;#34;lvv&amp;#34; attributes:@{NSFontAttributeName:[UIFont systemFontOfSize:30]}]; NSLayoutManager *layoutManager = [[NSLayoutManager alloc] init]; NSTextContainer *textContainer = [[NSTextContainer alloc] initWithSize:CGSizeMake(INFINITY, INFINITY)]; [layoutManager addTextContainer:textContainer]; // add layout at the last NSTextStorage *textStorage = [[NSTextStorage alloc] init]; [textStorage addLayoutManager:layoutManager]; // set string after add layout [textStorage setAttributedString:attrString]; CGRect usedRect = [layoutManager usedRectForTextContainer:textContainer]; NSLog(@&amp;#34;usedRect:%@&amp;#34;, NSStringFromCGRect(usedRect)); the result is correct:</description></item><item><title>Debug WebKit with Xcode on iOS simulator</title><link>/posts/2018/12/15_debugwebkit/</link><pubDate>Sat, 15 Dec 2018 00:00:00 +0800</pubDate><guid>/posts/2018/12/15_debugwebkit/</guid><description>Debug WebKit with Xcode on iOS simulator Build WebKit git clone git://git.webkit.org/WebKit.git WebKit cd WebKit sudo Tools/Scripts/configure-xcode-for-ios-development Tools/Scripts/build-webkit --debug --ios-simulator It will take 1 hour.
Configure WebKit.xcworkspace open WebKit.xcworkspace with Xcode File - Workspace Settings Advanced … Custom - Relative to Workspace Products: WebKitBuild Intermediates: WebKitBuild Done Configure MobileMiniBrowser open MobileMiniBrowser project in WebKit.xcworkspace change TARGETS (both MobileMiniBrowser and MobileMiniBrowser.framework) Build Settings - Base SDK: iOS change Architectures: Standard architectures (optional) Edit Info.</description></item></channel></rss>
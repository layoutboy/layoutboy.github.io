<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.62.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>Hugo 主题开发笔记&nbsp;&ndash;&nbsp;&#xF8FF;页面仔的笔记</title><link rel=stylesheet href=/css/core.min.1e87b996ec7e177d4ab41a11a34e82c1440a9ac075c7259295fe50e0ce0c6442da3e241bb93b3885dc338e4daf6bc28d.css integrity=sha384-Hoe5lux+F31KtBoRo06CwUQKmsB1xyWSlf5Q4M4MZELaPiQbuTs4hdwzjk2va8KN><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#00a300"><meta name=theme-color content="#ffffff"><body><div class=base-body><section id=header class="site header"><div class="header wrap"><span class="header left-side"><a class="site home" href=/><img class="site logo" src=/apple-touch-icon.png alt><span class="site name">&#xF8FF;页面仔的笔记</span></a></span>
<span class="header right-side"><a class="nav item" href=https://github.com/cntrump target=_blank><span class="iconfont icon-logo_github"></span>&nbsp;Github</a></span></div></section><div id=content><section class="article header"><h1 class="article title">Hugo 主题开发笔记</h1><p class="article date">Dec 26, 2019<span class=reading-time> • 预计阅读时间 2 分钟</span></p></section><article class="article markdown-body"><p>我的极简 Hugo 主题 <a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a> 已被收录到官方主题推荐列表。</p><p>记录一下开发过程中的一些心得。</p><h2 id=开发过程中>开发过程中</h2><ul><li><p>避免生成多余空行</p><p>Hugo 处理源文件时，会把 go 标记 <code>{{</code> <code>}}</code> 所在行替换为空行保留在生成后的页面里，要避免这种情况需要使用 <code>{{-</code> <code>-}}</code> 告诉编译器需要移除空白。</p><p>如果你的代码是这样的：</p><div class=highlight><pre class=chroma><code class=language-go-html-template data-lang=go-html-template><span class=cp>{{</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=na>...</span><span class=w> </span><span class=cp>}}</span>
<span class=cp>{{</span><span class=w> </span><span class=k>end</span><span class=w> </span><span class=cp>}}</span>
</code></pre></div><p>需要替换为</p><div class=highlight><pre class=chroma><code class=language-go-html-template data-lang=go-html-template><span class=cp>{{-</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=na>...</span><span class=w> </span><span class=cp>-}}</span>
<span class=cp>{{-</span><span class=w> </span><span class=k>end</span><span class=w> </span><span class=cp>-}}</span>
</code></pre></div></li><li><p>模块化重复使用的代码</p><p>在 <code>index.html</code> 和 <code>list.html</code> 都要显示文章列表和分页器，而且代码逻辑完全一样。</p><p>那么可以把重复的代码抽离出来放到 <code>partials</code> 里。</p><p><code>partials/note-list.html</code> 放文章列表布局的代码</p><p><code>partials/pagination.html</code> 放分页器的代码</p><p>使用的时候直接包含进来就可以了：</p><div class=highlight><pre class=chroma><code class=language-go-html-template data-lang=go-html-template><span class=cp>{{-</span><span class=w> </span><span class=nx>$paginator</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=na>.Paginator</span><span class=w> </span><span class=cp>-}}</span>

...

<span class=cp>{{-</span><span class=w> </span><span class=nx>partial</span><span class=w> </span><span class=s>&#34;note-list.html&#34;</span><span class=w> </span><span class=nx>$paginator</span><span class=w> </span><span class=cp>-}}</span>
<span class=cp>{{-</span><span class=w> </span><span class=nx>partial</span><span class=w> </span><span class=s>&#34;pagination.html&#34;</span><span class=w> </span><span class=nx>$paginator</span><span class=w> </span><span class=cp>-}}</span>
</code></pre></div><p><code>$paginator</code> 是传给 <code>partial</code> 的参数，在 <code>partial</code> 内部可以直接使用 <code>{{ . }}</code> 获取到这个参数。</p></li></ul><h2 id=上架到官方主题列表>上架到官方主题列表</h2><p>主题测试好了以后可以提交给 Hugo 官方审核，通过之后别人就可以在主题列表中发现你的主题。</p><p>上架的步骤如下：</p><ol><li><p>到 <a href=https://github.com/gohugoio/hugoThemes target=_blank>gohugoio/hugoThemes</a> 提交 Issues</p><p>主题是以 Issues 的形式进行评审的，不要提交为 PR。</p></li><li><p>主题的 ReadMe 中如果包含图片，需要使用<strong>绝对链接地址</strong>。</p><p>因为在 Hugo 主题页面内会直接提取 ReadMe 的内容进行展示。</p><p>如果是相对地址会导致显示不了图片，审核也不能通过。</p></li><li><p>需要提供主题的缩略图，路径是主题根目录的 <code>/images/</code> 目录，需要提供缩略图和大图</p><p><code>screenshot.png</code> 大图，w: 1500px, h: 1000px</p><p><code>tn.png</code> 缩略图，w: 900px, h: 600px</p><p>把 <code>screenshot.png</code> 显示在 ReadMe 的顶部</p></li><li><p>主题里使用到的链接，应该使用相对地址（<code>relURL</code>），因为官方在上架后会给你生成一个 Demo 站点</p><p>如果是使用 <code>BaseURL</code> 进行拼接的路径，或者以 <code>/</code> 开头的路径，会导致生成的 Demo 不能找到资源，审核也不能通过。</p><p>使用到外部资源的链接不能是 <code>//</code> 开头的形式，需要写为 <code>https://</code> 开头。</p></li><li><p>建议内置 <code>exampleSite</code> 在主题里，在主题根目录下创建一个 <code>exampleSite</code> 目录</p><p>把这个示例仓库<a href=https://github.com/gohugoio/HugoBasicExample target=_blank>HugoBasicExample</a>里的 <code>content</code> 目录拷贝进来，<strong>不能更改</strong>里面的文件内容。</p><p>在里面新建一个配置文件 <code>config.toml</code> ，里面的内容需要自己写，除了第一行必须是 <code>baseURL = "https://example.com"</code>, 配置文件的内容需要根据自己的主题进行填充。</p><p>主题需要能让这个例子正常运行起来才能上架，<code>cd</code> 到 <code>exampleSite</code> 目录里，执行 <code>hugo server --themesDir ../..</code> 测试效果。</p></li></ol></article><section class="article labels"><a class=tag href=/tags/hugo/>Hugo</a></section><section class="article navigation"><p><a class=link href=/posts/2019/12/27_update_lookin_on_jb_ios/><span class=li>&larr;</span>在越狱后的 iOS 上更新 Lookin 链接库</a></p><p><a class=link href=/posts/2019/12/25_h5_hash/><span class=li>&rarr;</span>使用 OpenSSL 计算脚本文件的 SHA384</a class="link"></p></section><section class="article discussion"><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"layoutboy"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div><section id=footer class=footer><div class=footer-wrap><p class=copyright>&copy;2020 LayoutBoy.</p><p class=powerby><span>Powered by </span><a href=https://gohugo.io target=_blank>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-155172933-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>